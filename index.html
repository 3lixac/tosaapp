<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å‹‰å¼·ãƒ­ã‚°ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f4f6f8;
      padding: 20px;
      transition: background-color 0.5s;
    }

    h1 {
      text-align: center;
    }

    .calendar-wrapper {
      max-width: 500px;
      margin: 20px auto;
    }

    .weekdays, .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .weekdays div {
      text-align: center;
      font-weight: bold;
    }

    .calendar .empty {
      visibility: hidden;
    }

    .day {
      background: #fff;
      padding: 10px;
      text-align: center;
      border-radius: 5px;
      cursor: pointer;
    }

    .day.selected {
      background: #4caf50;
      color: white;
    }

    .container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
    }

    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
    }

    button {
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    ul {
      padding-left: 0;
      margin-top: 15px;
    }

    li {
      list-style: none;
      display: flex;
      justify-content: space-between;
      background: #eee;
      padding: 8px;
      margin-bottom: 5px;
      border-radius: 5px;
    }

    .delete {
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 4px 6px;
      cursor: pointer;
    }

    .total, .month-total {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>ğŸ“… å‹‰å¼·ãƒ­ã‚°ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h1>

<div class="calendar-wrapper">
  <div class="weekdays">
    <div>æ—¥</div><div>æœˆ</div><div>ç«</div>
    <div>æ°´</div><div>æœ¨</div><div>é‡‘</div><div>åœŸ</div>
  </div>
  <div class="calendar" id="calendar"></div>
</div>

<div class="container">
  <div id="selectedDate">æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„</div>

  <input type="text" id="subject" placeholder="å‹‰å¼·å†…å®¹">
  <input type="number" id="time" placeholder="å‹‰å¼·æ™‚é–“ï¼ˆåˆ†ï¼‰">

  <button onclick="addLog()">ãƒ­ã‚°è¿½åŠ </button>

  <ul id="logList"></ul>
  <div class="total" id="totalTime"></div>
  <div class="month-total" id="monthTotal"></div>
</div>

<script>
  const calendar = document.getElementById("calendar");
  const logList = document.getElementById("logList");
  const selectedDateText = document.getElementById("selectedDate");
  const totalTimeText = document.getElementById("totalTime");
  const monthTotalText = document.getElementById("monthTotal");

  const logs = {};
  let selectedDate = null;

  const now = new Date();
  const year = now.getFullYear();
  const month = now.getMonth();
  const daysInMonth = new Date(year, month + 1, 0).getDate();
  const firstDay = new Date(year, month, 1).getDay();

  // ç©ºç™½ãƒã‚¹ï¼ˆæ›œæ—¥èª¿æ•´ï¼‰
  for (let i = 0; i < firstDay; i++) {
    const empty = document.createElement("div");
    empty.className = "empty";
    calendar.appendChild(empty);
  }

  // æ—¥ä»˜ç”Ÿæˆ
  for (let d = 1; d <= daysInMonth; d++) {
    const div = document.createElement("div");
    div.className = "day";
    div.textContent = d;
    div.onclick = () => selectDate(d, div);
    calendar.appendChild(div);
  }

  function selectDate(day, element) {
    document.querySelectorAll(".day").forEach(d => d.classList.remove("selected"));
    element.classList.add("selected");

    selectedDate = `${year}-${month + 1}-${day}`;
    selectedDateText.textContent = `${month + 1}æœˆ${day}æ—¥ã®å‹‰å¼·ãƒ­ã‚°`;

    renderLogs();
  }

  function addLog() {
    if (!selectedDate) {
      alert("æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„");
      return;
    }

    const subject = document.getElementById("subject").value;
    const time = Number(document.getElementById("time").value);

    if (!subject || time <= 0) return;

    if (!logs[selectedDate]) logs[selectedDate] = [];
    logs[selectedDate].push({ subject, time });

    renderLogs();
    document.getElementById("subject").value = "";
    document.getElementById("time").value = "";
  }

  function renderLogs() {
    logList.innerHTML = "";
    let total = 0;

    (logs[selectedDate] || []).forEach((log, index) => {
      const li = document.createElement("li");
      li.textContent = `${log.subject}ï¼š${log.time}åˆ†`;

      const del = document.createElement("button");
      del.textContent = "å‰Šé™¤";
      del.className = "delete";
      del.onclick = () => {
        logs[selectedDate].splice(index, 1);
        renderLogs();
      };

      li.appendChild(del);
      logList.appendChild(li);
      total += log.time;
    });

    totalTimeText.textContent = `ã“ã®æ—¥ã®åˆè¨ˆï¼š${total} åˆ†`;

    // æœˆåˆè¨ˆ
    let monthTotal = 0;
    for (const date in logs) {
      logs[date].forEach(log => monthTotal += log.time);
    }
    monthTotalText.textContent = `ä»Šæœˆã®åˆè¨ˆï¼š${monthTotal} åˆ†`;

    // èƒŒæ™¯è‰²
    document.body.style.backgroundColor =
      total < 30 ? "#f4f6f8" :
      total < 60 ? "#e8f5e9" :
      "#fff3cd";
  }
</script>

</body>
</html>
